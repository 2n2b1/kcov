<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  <title>Coverage - dissy</title>
  <link rel="stylesheet" type="text/css" href="bcov.css"/>
</head>
<body>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
  <tr><td class="title">Coverage Report</td></tr>
  <tr><td class="ruler"><img src="glass.png" width="3" height="3" alt=""/></td></tr>
  <tr>
    <td width="100%">
      <table cellpadding="1" border="0" width="100%">
        <tr>
          <td class="headerItem" width="20%">Command:</td>
          <td class="headerValue" width="80%" colspan=6>dissy</td>
        </tr>
        <tr>
          <td class="headerItem" width="20%">Date:</td>
          <td class="headerValue" width="15%">2014-03-01 10:23:30</td>
          <td width="5%"></td>
          <td class="headerItem" width="20%">Instrumented&nbsp;lines:</td>
          <td class="headerValue" width="10%">503</td>
        </tr>
        <tr>
          <td class="headerItem" width="20%">Code&nbsp;covered:</td>
          <td class="coverPerLeftMed" width="15%">48.3%</td>
          <td width="5%"></td>
          <td class="headerItem" width="20%">Executed&nbsp;lines:</td>
          <td class="headerValue" width="10%">243</td>
        </tr>
      </table>
    </td>
  </tr>
  <tr><td class="ruler"><img src="glass.png" width="3" height="3" alt=""/></td></tr>
</table>
<pre class="source">
<span class="lineNum">    1</span>              : #!&#047;usr&#047;bin&#047;env python </span>
<span class="lineNum">    2</span>              : ###################################################################### </span>
<span class="lineNum">    3</span>              : ## </span>
<span class="lineNum">    4</span>              : ## Copyright (C) 2006,  Blekinge Institute of Technology </span>
<span class="lineNum">    5</span>              : ## </span>
<span class="lineNum">    6</span>              : ## Author:        Simon Kagstrom &lt;simon.kagstrom@gmail.com&gt; </span>
<span class="lineNum">    7</span>              : ## Description:   The main program </span>
<span class="lineNum">    8</span>              : ## </span>
<span class="lineNum">    9</span>              : ## Licensed under the terms of GNU General Public License version 2 </span>
<span class="lineNum">   10</span>              : ## (or later, at your option). See COPYING file distributed with Dissy </span>
<span class="lineNum">   11</span>              : ## for full text of the license. </span>
<span class="lineNum">   12</span>              : ## </span>
<span class="lineNum">   13</span>              : ###################################################################### </span>
<span class="lineNum">   14</span><span class="lineCov">      1  /   1: import pygtk, pango, getopt, sys, os, cgi, re </span>
<span class="lineNum">   15</span>              :  </span>
<span class="lineNum">   16</span><span class="lineCov">      1  /   1: sys.path.append(&quot;.&quot;) </span>
<span class="lineNum">   17</span><span class="lineCov">      1  /   1: sys.path = [&#039;&#047;home&#047;ska&#047;projects&#047;dissy&#047;&#039;] + sys.path </span>
<span class="lineNum">   18</span>              :  </span>
<span class="lineNum">   19</span><span class="lineCov">      1  /   1: pygtk.require(&#039;2.0&#039;) </span>
<span class="lineNum">   20</span><span class="lineCov">      1  /   1: import gtk, gobject </span>
<span class="lineNum">   21</span><span class="lineCov">      1  /   1: gtk.gdk.threads_init() </span>
<span class="lineNum">   22</span>              :  </span>
<span class="lineNum">   23</span><span class="lineCov">      1  /   1: from dissy.Config import * </span>
<span class="lineNum">   24</span><span class="lineCov">      1  /   1: from dissy.File import File, ExportedFile </span>
<span class="lineNum">   25</span><span class="lineCov">      1  /   1: from dissy.File import linuxKernelCrashRegexp </span>
<span class="lineNum">   26</span><span class="lineCov">      1  /   1: from dissy.Entity import Entity </span>
<span class="lineNum">   27</span><span class="lineCov">      1  /   1: from dissy.StrEntity import StrEntity </span>
<span class="lineNum">   28</span><span class="lineCov">      1  /   1: from dissy.Instruction import Instruction </span>
<span class="lineNum">   29</span><span class="lineCov">      1  /   1: from dissy.Function import Function </span>
<span class="lineNum">   30</span><span class="lineCov">      1  /   1: from dissy.PreferencesDialogue import PreferencesDialogue </span>
<span class="lineNum">   31</span><span class="lineCov">      1  /   1: from dissy.history import History </span>
<span class="lineNum">   32</span><span class="lineCov">      1  /   1: from dissy import FunctionModel </span>
<span class="lineNum">   33</span><span class="lineCov">      1  /   1: from dissy import InstructionModel </span>
<span class="lineNum">   34</span><span class="lineCov">      1  /   1: from dissy import InstructionModelHighlighter </span>
<span class="lineNum">   35</span><span class="lineCov">      1  /   1: from dissy.InfoBox import InfoBox </span>
<span class="lineNum">   36</span>              :  </span>
<span class="lineNum">   37</span>              : #Value analysis requires the WALi python bindings </span>
<span class="lineNum">   38</span><span class="lineCov">      1  /   1: enable_value_analysis = False </span>
<span class="lineNum">   39</span><span class="lineCov">      1  /   1: try: </span>
<span class="lineNum">   40</span><span class="lineCov">      1  /   1:     import wali </span>
<span class="lineNum">   41</span><span class="lineNoCov">      0  /   1:     print &#039;Enabling value analysis&#039; </span>
<span class="lineNum">   42</span><span class="lineNoCov">      0  /   1:     enable_value_analysis = True </span>
<span class="lineNum">   43</span><span class="lineNoCov">      0  /   1:     from dissy.ValueAnalysisInfoProvider import ValueAnalysisInfoProvider </span>
<span class="lineNum">   44</span><span class="lineCov">      1  /   1: except: </span>
<span class="lineNum">   45</span><span class="lineCov">      1  /   1:     pass </span>
<span class="lineNum">   46</span>              :  </span>
<span class="lineNum">   47</span><span class="lineCov">      1  /   1: NUM_JUMP_COLUMNS=3 </span>
<span class="lineNum">   48</span>              :  </span>
<span class="lineNum">   49</span>              : # Navigation history </span>
<span class="lineNum">   50</span><span class="lineCov">      1  /   1: history = History() </span>
<span class="lineNum">   51</span>              :  </span>
<span class="lineNum">   52</span><span class="lineCov">      1  /   1: class GUI_Controller: </span>
<span class="lineNum">   53</span>              :     &quot;&quot;&quot; The GUI class is the controller for Dissy &quot;&quot;&quot; </span>
<span class="lineNum">   54</span>              :  </span>
<span class="lineNum">   55</span><span class="lineCov">      1  /   1:     def __init__(self, inFile=None): </span>
<span class="lineNum">   56</span><span class="lineCov">      1  /   1:         if inFile == None: </span>
<span class="lineNum">   57</span><span class="lineNoCov">      0  /   1:             inFile = &quot;&quot; </span>
<span class="lineNum">   58</span><span class="lineCov">      1  /   1:         self.fileContainer = File(baseAddress=baseAddress) </span>
<span class="lineNum">   59</span>              :  </span>
<span class="lineNum">   60</span><span class="lineCov">      1  /   1:         icon = None </span>
<span class="lineNum">   61</span><span class="lineCov">      1  /   1:         icon_name = lookupFile(&#039;gfx&#047;icon.svg&#039;) </span>
<span class="lineNum">   62</span><span class="lineCov">      1  /   1:         if icon_name != None: </span>
<span class="lineNum">   63</span><span class="lineCov">      1  /   1:             icon = gtk.gdk.pixbuf_new_from_file(icon_name) </span>
<span class="lineNum">   64</span><span class="lineCov">      1  /   1:             icon = icon.scale_simple(64, 64, gtk.gdk.INTERP_BILINEAR) </span>
<span class="lineNum">   65</span>              :  </span>
<span class="lineNum">   66</span>              :         #GUI setup from gtk.Builder </span>
<span class="lineNum">   67</span><span class="lineCov">      1  /   1:         builder = gtk.Builder() </span>
<span class="lineNum">   68</span><span class="lineCov">      1  /   1:         ui_file_name = lookupFile(&quot;dissy.ui&quot;) </span>
<span class="lineNum">   69</span><span class="lineCov">      1  /   1:         if ui_file_name == None: </span>
<span class="lineNum">   70</span><span class="lineNoCov">      0  /   1:             sys.stderr.write(&quot;Cannot find the dissy UI definition file (dissy.ui)&#092;n&quot;) </span>
<span class="lineNum">   71</span><span class="lineNoCov">      0  /   1:             sys.exit(1) </span>
<span class="lineNum">   72</span><span class="lineCov">      1  /   1:         builder.add_from_file(ui_file_name) </span>
<span class="lineNum">   73</span><span class="lineCov">      1  /   1:         self.root = builder.get_object(&#039;mainWindow&#039;) </span>
<span class="lineNum">   74</span><span class="lineCov">      1  /   1:         self.root.set_title(&quot;%s - %s&quot; % (PROGRAM_NAME, inFile)) </span>
<span class="lineNum">   75</span><span class="lineCov">      1  /   1:         self.root.set_icon(icon) </span>
<span class="lineNum">   76</span><span class="lineCov">      1  /   1:         builder.connect_signals(self) </span>
<span class="lineNum">   77</span><span class="lineCov">      1  /   1:         self.root.show_all() </span>
<span class="lineNum">   78</span>              :  </span>
<span class="lineNum">   79</span>              :         #setup infobox </span>
<span class="lineNum">   80</span><span class="lineCov">      1  /   1:         self.vboxInfoBox = builder.get_object(&#039;vboxInfoBox&#039;) </span>
<span class="lineNum">   81</span><span class="lineCov">      1  /   1:         self.infoBox = InfoBox() </span>
<span class="lineNum">   82</span><span class="lineCov">      1  /   1:         scrwInfoBox = builder.get_object(&#039;scrwInfoBox&#039;) </span>
<span class="lineNum">   83</span><span class="lineCov">      1  /   1:         scrwInfoBox.add(self.infoBox) </span>
<span class="lineNum">   84</span><span class="lineCov">      1  /   1:         scrwInfoBox.show_all() </span>
<span class="lineNum">   85</span>              :  </span>
<span class="lineNum">   86</span><span class="lineCov">      1  /   1:         lookupCombo = builder.get_object(&#039;lookupCombo&#039;) </span>
<span class="lineNum">   87</span><span class="lineCov">      1  /   1:         liststore = gtk.ListStore(gobject.TYPE_STRING) </span>
<span class="lineNum">   88</span><span class="lineCov">      1  /   1:         lookupCombo.set_model(liststore) </span>
<span class="lineNum">   89</span><span class="lineCov">      1  /   1:         lookupCombo.set_text_column(0) </span>
<span class="lineNum">   90</span><span class="lineCov">      1  /   1:         lookupCombo.child.connect(&quot;activate&quot;, self.pasteBinEntryActivated, lookupCombo) </span>
<span class="lineNum">   91</span><span class="lineCov">      1  /   1:         lookupCombo.connect(&quot;changed&quot;, self.pasteBinChanged, lookupCombo) </span>
<span class="lineNum">   92</span>              :  </span>
<span class="lineNum">   93</span><span class="lineCov">      1  /   1:         highlightEntry = builder.get_object(&#039;highlightEntry&#039;) </span>
<span class="lineNum">   94</span><span class="lineCov">      1  /   1:         highlightEntry.connect(&quot;activate&quot;, self.patternMatchBinCallback, highlightEntry) </span>
<span class="lineNum">   95</span>              :  </span>
<span class="lineNum">   96</span><span class="lineCov">      1  /   1:         self.vpaned = builder.get_object(&#039;vpaned&#039;) </span>
<span class="lineNum">   97</span><span class="lineCov">      1  /   1:         self.vpaned.set_position(650&#047;3) </span>
<span class="lineNum">   98</span><span class="lineCov">      1  /   1:         self.hpaned_down = builder.get_object(&#039;hpaned&#039;) </span>
<span class="lineNum">   99</span><span class="lineCov">      1  /   1:         self.hpaned_down.set_position(900&#047;3*2) </span>
<span class="lineNum">  100</span>              :  </span>
<span class="lineNum">  101</span>              :         #Set shortcuts, that doesn&#039;t work from Gtk.Builder </span>
<span class="lineNum">  102</span><span class="lineCov">      1  /   1:         accelgroupMainWin = builder.get_object(&#039;accelgroupMainWin&#039;) </span>
<span class="lineNum">  103</span><span class="lineCov">      1  /   1:         builder.get_object(&#039;mnuShowSource&#039;).add_accelerator(&#039;activate&#039;, accelgroupMainWin, ord(&#039;u&#039;), </span>
<span class="lineNum">  104</span><span class="lineCov">      1  /   1:             gtk.gdk.CONTROL_MASK, gtk.ACCEL_VISIBLE) </span>
<span class="lineNum">  105</span><span class="lineCov">      1  /   1:         builder.get_object(&#039;navBack&#039;).add_accelerator(&#039;activate&#039;, accelgroupMainWin, </span>
<span class="lineNum">  106</span><span class="lineCov">      1  /   1:             gtk.gdk.keyval_from_name(&#039;Left&#039;), </span>
<span class="lineNum">  107</span><span class="lineCov">      1  /   1:             gtk.gdk.MOD1_MASK, gtk.ACCEL_VISIBLE) </span>
<span class="lineNum">  108</span><span class="lineCov">      1  /   1:         builder.get_object(&#039;navForward&#039;).add_accelerator(&#039;activate&#039;, accelgroupMainWin, </span>
<span class="lineNum">  109</span><span class="lineCov">      1  /   1:             gtk.gdk.keyval_from_name(&#039;Right&#039;), </span>
<span class="lineNum">  110</span><span class="lineCov">      1  /   1:             gtk.gdk.MOD1_MASK, gtk.ACCEL_VISIBLE) </span>
<span class="lineNum">  111</span>              :  </span>
<span class="lineNum">  112</span>              :         # Get the model and attach it to the view </span>
<span class="lineNum">  113</span><span class="lineCov">      1  /   1:         self.searchwordHighlighter = InstructionModelHighlighter.SearchwordHighlighter() </span>
<span class="lineNum">  114</span><span class="lineCov">      1  /   1:         self.conditionFlagHighlighter = InstructionModelHighlighter.ConditionFlagHighlighter() </span>
<span class="lineNum">  115</span><span class="lineNoCov">      0  /   1:         self.highlighters = [ </span>
<span class="lineNum">  116</span><span class="lineCov">      1  /   1:             self.searchwordHighlighter, </span>
<span class="lineNum">  117</span><span class="lineCov">      1  /   1:             self.conditionFlagHighlighter, </span>
<span class="lineNum">  118</span><span class="lineNoCov">      0  /   1:         ] </span>
<span class="lineNum">  119</span>              :  </span>
<span class="lineNum">  120</span><span class="lineCov">      1  /   1:         self.enableValueAnalysis(builder) </span>
<span class="lineNum">  121</span>              :  </span>
<span class="lineNum">  122</span>              :         # Setup focus chains (no tab-to-focus in the information box) </span>
<span class="lineNum">  123</span><span class="lineCov">      1  /   1:         builder.get_object(&#039;vboxMain&#039;).set_focus_chain([ self.vpaned ]) </span>
<span class="lineNum">  124</span><span class="lineCov">      1  /   1:         self.hpaned_down.set_focus_chain([ builder.get_object(&#039;scrwInstruction&#039;) ]) </span>
<span class="lineNum">  125</span>              :  </span>
<span class="lineNum">  126</span><span class="lineCov">      1  /   1:         self.instructionView = builder.get_object(&#039;instructionView&#039;) </span>
<span class="lineNum">  127</span><span class="lineCov">      1  /   1:         self.instructionController = InstructionViewController(self, self.instructionView) </span>
<span class="lineNum">  128</span>              :  </span>
<span class="lineNum">  129</span><span class="lineCov">      1  /   1:         self.functionView = builder.get_object(&#039;functionView&#039;) </span>
<span class="lineNum">  130</span><span class="lineCov">      1  /   1:         self.functionController = FunctionViewController(self, self.functionView, </span>
<span class="lineNum">  131</span><span class="lineCov">      1  /   1:             self.instructionController) </span>
<span class="lineNum">  132</span>              :  </span>
<span class="lineNum">  133</span>              :         #Load settings </span>
<span class="lineNum">  134</span><span class="lineCov">      1  /   1:         self.loading = True </span>
<span class="lineNum">  135</span><span class="lineCov">      1  /   1:         builder.get_object(&#039;actionShowInformationBox&#039;).set_active(config.showInstructionInformationBox) </span>
<span class="lineNum">  136</span><span class="lineCov">      1  /   1:         builder.get_object(&#039;actionShowSource&#039;).set_active(config.showHighLevelCode) </span>
<span class="lineNum">  137</span><span class="lineCov">      1  /   1:         self.setInformationBoxVisible() </span>
<span class="lineNum">  138</span><span class="lineCov">      1  /   1:         self.loading = False </span>
<span class="lineNum">  139</span><span class="lineCov">      1  /   1:         if inFile: </span>
<span class="lineNum">  140</span><span class="lineCov">      1  /   1:             self.loadFile(inFile) </span>
<span class="lineNum">  141</span>              :  </span>
<span class="lineNum">  142</span><span class="lineCov">      1  /   1:         self.root.resize(config.width, config.height) </span>
<span class="lineNum">  143</span>              :  </span>
<span class="lineNum">  144</span><span class="lineCov">      1  /   1:     def on_navBack_activate(self, widget): </span>
<span class="lineNum">  145</span><span class="lineCov">      1  /   1:         try: </span>
<span class="lineNum">  146</span><span class="lineCov">      1  /   1:             val = history.back() </span>
<span class="lineNum">  147</span><span class="lineCov">      1  /   1:         except: </span>
<span class="lineNum">  148</span><span class="lineCov">      1  /   1:             return </span>
<span class="lineNum">  149</span><span class="lineNoCov">      0  /   1:         return self.lookupFunction(val) </span>
<span class="lineNum">  150</span>              :  </span>
<span class="lineNum">  151</span><span class="lineCov">      1  /   1:     def on_navForward_activate(self, widget): </span>
<span class="lineNum">  152</span><span class="lineCov">      1  /   1:         try: </span>
<span class="lineNum">  153</span><span class="lineCov">      1  /   1:             val = history.forward() </span>
<span class="lineNum">  154</span><span class="lineCov">      1  /   1:         except: </span>
<span class="lineNum">  155</span><span class="lineCov">      1  /   1:             return </span>
<span class="lineNum">  156</span><span class="lineNoCov">      0  /   1:         return self.lookupFunction(val) </span>
<span class="lineNum">  157</span>              :  </span>
<span class="lineNum">  158</span><span class="lineCov">      1  /   1:     def on_quit(self, widget=None): </span>
<span class="lineNum">  159</span><span class="lineCov">      1  /   1:         config.width, config.height = self.root.get_size() </span>
<span class="lineNum">  160</span><span class="lineCov">      1  /   1:         config.save() </span>
<span class="lineNum">  161</span><span class="lineCov">      1  /   1:         gtk.main_quit() </span>
<span class="lineNum">  162</span><span class="lineCov">      1  /   1:         return </span>
<span class="lineNum">  163</span>              :  </span>
<span class="lineNum">  164</span><span class="lineCov">      1  /   1:     def on_mnuSave_activate(self, widget): </span>
<span class="lineNum">  165</span>              :         #TODO - refactor file handling </span>
<span class="lineNum">  166</span><span class="lineNoCov">      0  /   1:         pass </span>
<span class="lineNum">  167</span>              :  </span>
<span class="lineNum">  168</span><span class="lineCov">      1  /   1:     def on_mnuOpen_activate(self, widget): </span>
<span class="lineNum">  169</span><span class="lineNoCov">      0  /   1:         file_open_dialog = gtk.FileChooserDialog(title=&quot;Open object file&quot;, </span>
<span class="lineNum">  170</span><span class="lineNoCov">      0  /   1:             action=gtk.FILE_CHOOSER_ACTION_OPEN, </span>
<span class="lineNum">  171</span><span class="lineNoCov">      0  /   1:                 buttons=(gtk.STOCK_CANCEL, </span>
<span class="lineNum">  172</span><span class="lineNoCov">      0  /   1:                         gtk.RESPONSE_CANCEL, </span>
<span class="lineNum">  173</span><span class="lineNoCov">      0  /   1:                         gtk.STOCK_OPEN, </span>
<span class="lineNum">  174</span><span class="lineNoCov">      0  /   1:                         gtk.RESPONSE_OK)) </span>
<span class="lineNum">  175</span><span class="lineNoCov">      0  /   1:         filter = gtk.FileFilter() </span>
<span class="lineNum">  176</span><span class="lineNoCov">      0  /   1:         filter.set_name(&quot;Object files&quot;) </span>
<span class="lineNum">  177</span><span class="lineNoCov">      0  /   1:         filter.add_pattern(&quot;*.o&quot;) </span>
<span class="lineNum">  178</span><span class="lineNoCov">      0  /   1:         filter.add_mime_type(&quot;application&#047;x-object&quot;) </span>
<span class="lineNum">  179</span><span class="lineNoCov">      0  /   1:         filter.add_mime_type(&quot;application&#047;x-executable&quot;) </span>
<span class="lineNum">  180</span><span class="lineNoCov">      0  /   1:         file_open_dialog.add_filter(filter) </span>
<span class="lineNum">  181</span>              :  </span>
<span class="lineNum">  182</span><span class="lineNoCov">      0  /   1:         filter = gtk.FileFilter() </span>
<span class="lineNum">  183</span><span class="lineNoCov">      0  /   1:         filter.set_name(&quot;Dissy exported files (*.dissy)&quot;) </span>
<span class="lineNum">  184</span><span class="lineNoCov">      0  /   1:         filter.add_pattern(&quot;*.dissy&quot;) </span>
<span class="lineNum">  185</span><span class="lineNoCov">      0  /   1:         file_open_dialog.add_filter(filter) </span>
<span class="lineNum">  186</span>              :  </span>
<span class="lineNum">  187</span><span class="lineNoCov">      0  /   1:         filter = gtk.FileFilter() </span>
<span class="lineNum">  188</span><span class="lineNoCov">      0  /   1:         filter.set_name(&quot;All files&quot;) </span>
<span class="lineNum">  189</span><span class="lineNoCov">      0  /   1:         filter.add_pattern(&quot;*&quot;) </span>
<span class="lineNum">  190</span><span class="lineNoCov">      0  /   1:         file_open_dialog.add_filter(filter) </span>
<span class="lineNum">  191</span>              :  </span>
<span class="lineNum">  192</span><span class="lineNoCov">      0  /   1:         if file_open_dialog.run() == gtk.RESPONSE_OK: </span>
<span class="lineNum">  193</span><span class="lineNoCov">      0  /   1:             filename = file_open_dialog.get_filename() </span>
<span class="lineNum">  194</span><span class="lineNoCov">      0  /   1:             self.loadFile(filename) </span>
<span class="lineNum">  195</span><span class="lineNoCov">      0  /   1:             file_open_dialog.destroy() </span>
<span class="lineNum">  196</span>              :         else: </span>
<span class="lineNum">  197</span><span class="lineNoCov">      0  /   1:             file_open_dialog.destroy() </span>
<span class="lineNum">  198</span>              :  </span>
<span class="lineNum">  199</span><span class="lineCov">      1  /   1:     def on_mnuReload_activate(self, widget): </span>
<span class="lineNum">  200</span><span class="lineNoCov">      0  /   1:         self.loadFile() </span>
<span class="lineNum">  201</span>              :  </span>
<span class="lineNum">  202</span><span class="lineCov">      1  /   1:     def loadFile(self, filename=None): </span>
<span class="lineNum">  203</span><span class="lineNoCov">      0  /   1:         global enable_value_analysis </span>
<span class="lineNum">  204</span><span class="lineCov">      1  /   1:         if filename == None: </span>
<span class="lineNum">  205</span><span class="lineNoCov">      0  /   1:             if not self.fileContainer: </span>
<span class="lineNum">  206</span><span class="lineNoCov">      0  /   1:                 return </span>
<span class="lineNum">  207</span><span class="lineNoCov">      0  /   1:             filename = self.fileContainer.filename </span>
<span class="lineNum">  208</span>              :  </span>
<span class="lineNum">  209</span><span class="lineCov">      1  /   1:         self.root.set_title(&quot;%s - %s&quot; % (PROGRAM_NAME, filename)) </span>
<span class="lineNum">  210</span><span class="lineCov">      1  /   1:         if filename.endswith(&#039;.dissy&#039;): </span>
<span class="lineNum">  211</span><span class="lineNoCov">      0  /   1:             self.fileContainer = ExportedFile(filename, baseAddress=baseAddress) </span>
<span class="lineNum">  212</span>              :         else: </span>
<span class="lineNum">  213</span><span class="lineCov">      1  /   1:             self.fileContainer = File(filename, baseAddress=baseAddress) </span>
<span class="lineNum">  214</span><span class="lineCov">      1  /   1:         self.functionView.set_model( FunctionModel.InfoModel(self.fileContainer).getModel() ) </span>
<span class="lineNum">  215</span><span class="lineCov">      1  /   1:         if enable_value_analysis: </span>
<span class="lineNum">  216</span><span class="lineNoCov">      0  /   1:             self.valueAnalysisInfoProvider = ValueAnalysisInfoProvider(self.fileContainer) </span>
<span class="lineNum">  217</span>              :  </span>
<span class="lineNum">  218</span><span class="lineCov">      1  /   1:     def on_mnuSaveAs_activate(self, widget): </span>
<span class="lineNum">  219</span><span class="lineNoCov">      0  /   1:         file_save_dialog = gtk.FileChooserDialog(title=&quot;Export file&quot;, </span>
<span class="lineNum">  220</span><span class="lineNoCov">      0  /   1:             action=gtk.FILE_CHOOSER_ACTION_SAVE, </span>
<span class="lineNum">  221</span><span class="lineNoCov">      0  /   1:                 buttons=(gtk.STOCK_CANCEL, </span>
<span class="lineNum">  222</span><span class="lineNoCov">      0  /   1:                         gtk.RESPONSE_CANCEL, </span>
<span class="lineNum">  223</span><span class="lineNoCov">      0  /   1:                         gtk.STOCK_SAVE, </span>
<span class="lineNum">  224</span><span class="lineNoCov">      0  /   1:                         gtk.RESPONSE_OK)) </span>
<span class="lineNum">  225</span><span class="lineNoCov">      0  /   1:         filter = gtk.FileFilter() </span>
<span class="lineNum">  226</span><span class="lineNoCov">      0  /   1:         filter.set_name(&quot;Dissy exported files (*.dissy)&quot;) </span>
<span class="lineNum">  227</span><span class="lineNoCov">      0  /   1:         filter.add_pattern(&quot;*.dissy&quot;) </span>
<span class="lineNum">  228</span><span class="lineNoCov">      0  /   1:         file_save_dialog.add_filter(filter) </span>
<span class="lineNum">  229</span>              :  </span>
<span class="lineNum">  230</span><span class="lineNoCov">      0  /   1:         if file_save_dialog.run() == gtk.RESPONSE_OK: </span>
<span class="lineNum">  231</span><span class="lineNoCov">      0  /   1:             filename = file_save_dialog.get_filename() </span>
<span class="lineNum">  232</span><span class="lineNoCov">      0  /   1:             file_save_dialog.destroy() </span>
<span class="lineNum">  233</span>              :         else: </span>
<span class="lineNum">  234</span><span class="lineNoCov">      0  /   1:             file_save_dialog.destroy() </span>
<span class="lineNum">  235</span><span class="lineNoCov">      0  /   1:             return </span>
<span class="lineNum">  236</span>              :  </span>
<span class="lineNum">  237</span><span class="lineNoCov">      0  /   1:         if not filename.endswith(&#039;.dissy&#039;): </span>
<span class="lineNum">  238</span><span class="lineNoCov">      0  /   1:             filename += &#039;.dissy&#039; </span>
<span class="lineNum">  239</span>              :  </span>
<span class="lineNum">  240</span><span class="lineNoCov">      0  /   1:         f = open(filename, &#039;wb&#039;) </span>
<span class="lineNum">  241</span><span class="lineNoCov">      0  /   1:         expfile = self.fileContainer.toExportedFile() </span>
<span class="lineNum">  242</span><span class="lineNoCov">      0  /   1:         expfile.saveTo(f) </span>
<span class="lineNum">  243</span><span class="lineNoCov">      0  /   1:         f.close() </span>
<span class="lineNum">  244</span>              :  </span>
<span class="lineNum">  245</span><span class="lineCov">      1  /   1:     def on_mnuAbout_activate(self, w=None): </span>
<span class="lineNum">  246</span><span class="lineNoCov">      0  /   1:         &quot;Display the about dialogue&quot; </span>
<span class="lineNum">  247</span><span class="lineNoCov">      0  /   1:         about = gtk.AboutDialog() </span>
<span class="lineNum">  248</span><span class="lineNoCov">      0  /   1:         about.set_name(PROGRAM_NAME) </span>
<span class="lineNum">  249</span><span class="lineNoCov">      0  /   1:         about.set_version(&quot;v%s&quot; % (PROGRAM_VERSION) ) </span>
<span class="lineNum">  250</span><span class="lineNoCov">      0  /   1:         about.set_copyright(&quot;(C) Simon Kagstrom, 2006-2011&quot;) </span>
<span class="lineNum">  251</span><span class="lineNoCov">      0  /   1:         about.set_website(PROGRAM_URL) </span>
<span class="lineNum">  252</span><span class="lineNoCov">      0  /   1:         about.run() </span>
<span class="lineNum">  253</span><span class="lineNoCov">      0  /   1:         about.hide() </span>
<span class="lineNum">  254</span>              :  </span>
<span class="lineNum">  255</span><span class="lineCov">      1  /   1:     def redisplayFunction(self): </span>
<span class="lineNum">  256</span><span class="lineNoCov">      0  /   1:         try: </span>
<span class="lineNum">  257</span><span class="lineNoCov">      0  /   1:             fnCursor = self.functionView.get_cursor()[0] </span>
<span class="lineNum">  258</span><span class="lineNoCov">      0  /   1:             curFunction = self.functionView.get_model()[fnCursor][3] </span>
<span class="lineNum">  259</span><span class="lineNoCov">      0  /   1:         except TypeError: </span>
<span class="lineNum">  260</span>              :             # There is no function currently being shown </span>
<span class="lineNum">  261</span><span class="lineNoCov">      0  /   1:             return </span>
<span class="lineNum">  262</span><span class="lineNoCov">      0  /   1:         insnCursor = self.instructionView.get_cursor()[0] </span>
<span class="lineNum">  263</span><span class="lineNoCov">      0  /   1:         curInstruction = None </span>
<span class="lineNum">  264</span><span class="lineNoCov">      0  /   1:         if insnCursor: </span>
<span class="lineNum">  265</span><span class="lineNoCov">      0  /   1:             curInstruction = self.instructionView.get_model()[insnCursor][self.instructionModel.COLUMN_INSTRUCTION] </span>
<span class="lineNum">  266</span>              :  </span>
<span class="lineNum">  267</span><span class="lineNoCov">      0  /   1:         self.instructionModel.setCurInstruction(curInstruction) </span>
<span class="lineNum">  268</span><span class="lineNoCov">      0  /   1:         self.instructionModel.refreshModel() </span>
<span class="lineNum">  269</span><span class="lineNoCov">      0  /   1:         try: </span>
<span class="lineNum">  270</span><span class="lineNoCov">      0  /   1:             self.instructionView.set_cursor(insnCursor) </span>
<span class="lineNum">  271</span><span class="lineNoCov">      0  /   1:             self.instructionView.scroll_to_cell(insnCursor) </span>
<span class="lineNum">  272</span><span class="lineNoCov">      0  /   1:         except: # If nothing is selected this will fail </span>
<span class="lineNum">  273</span><span class="lineNoCov">      0  /   1:             pass </span>
<span class="lineNum">  274</span>              :  </span>
<span class="lineNum">  275</span><span class="lineCov">      1  /   1:     def on_actionShowSource_toggled(self, action): </span>
<span class="lineNum">  276</span><span class="lineCov">      1  /   1:         if self.loading: </span>
<span class="lineNum">  277</span><span class="lineCov">      1  /   1:             return </span>
<span class="lineNum">  278</span><span class="lineNoCov">      0  /   1:         config.showHighLevelCode = not config.showHighLevelCode </span>
<span class="lineNum">  279</span><span class="lineNoCov">      0  /   1:         config.save() </span>
<span class="lineNum">  280</span><span class="lineNoCov">      0  /   1:         try: </span>
<span class="lineNum">  281</span><span class="lineNoCov">      0  /   1:             fnCursor = self.functionView.get_cursor()[0] </span>
<span class="lineNum">  282</span><span class="lineNoCov">      0  /   1:             curFunction = self.functionView.get_model()[fnCursor][3] </span>
<span class="lineNum">  283</span><span class="lineNoCov">      0  /   1:         except TypeError: </span>
<span class="lineNum">  284</span>              :             # There is no function currently being shown </span>
<span class="lineNum">  285</span><span class="lineNoCov">      0  /   1:             return </span>
<span class="lineNum">  286</span><span class="lineNoCov">      0  /   1:         model = self.instructionView.get_model() </span>
<span class="lineNum">  287</span><span class="lineNoCov">      0  /   1:         curpath = self.instructionView.get_cursor()[0] </span>
<span class="lineNum">  288</span><span class="lineNoCov">      0  /   1:         try: </span>
<span class="lineNum">  289</span><span class="lineNoCov">      0  /   1:             curaddr = model[curpath][self.instructionModel.COLUMN_INSTRUCTION].address </span>
<span class="lineNum">  290</span><span class="lineNoCov">      0  /   1:         except: </span>
<span class="lineNum">  291</span><span class="lineNoCov">      0  /   1:             curaddr = None </span>
<span class="lineNum">  292</span><span class="lineNoCov">      0  /   1:         self.instructionView.set_model( InstructionModel.InfoModel(curFunction).getModel() ) </span>
<span class="lineNum">  293</span><span class="lineNoCov">      0  /   1:         if curaddr: </span>
<span class="lineNum">  294</span><span class="lineNoCov">      0  /   1:             self.lookupFunction(curaddr) </span>
<span class="lineNum">  295</span>              :  </span>
<span class="lineNum">  296</span><span class="lineCov">      1  /   1:     def on_actionShowInformationBox_toggled(self, widget): </span>
<span class="lineNum">  297</span><span class="lineCov">      1  /   1:         if self.loading: </span>
<span class="lineNum">  298</span><span class="lineCov">      1  /   1:             return </span>
<span class="lineNum">  299</span><span class="lineNoCov">      0  /   1:         config.showInstructionInformationBox = not config.showInstructionInformationBox </span>
<span class="lineNum">  300</span><span class="lineNoCov">      0  /   1:         config.save() </span>
<span class="lineNum">  301</span><span class="lineNoCov">      0  /   1:         self.setInformationBoxVisible() </span>
<span class="lineNum">  302</span>              :  </span>
<span class="lineNum">  303</span><span class="lineCov">      1  /   1:     def setInformationBoxVisible(self): </span>
<span class="lineNum">  304</span><span class="lineCov">      1  /   1:         if config.showInstructionInformationBox: </span>
<span class="lineNum">  305</span><span class="lineNoCov">      0  /   1:             self.vboxInfoBox.show() </span>
<span class="lineNum">  306</span>              :         else: </span>
<span class="lineNum">  307</span><span class="lineCov">      1  /   1:             self.vboxInfoBox.hide() </span>
<span class="lineNum">  308</span>              :  </span>
<span class="lineNum">  309</span><span class="lineCov">      1  /   1:     def on_mnuPreferences_activate(self, widget): </span>
<span class="lineNum">  310</span><span class="lineCov">      1  /   1:         pd = PreferencesDialogue(self) </span>
<span class="lineNum">  311</span>              :  </span>
<span class="lineNum">  312</span><span class="lineCov">      1  /   1:     def enableValueAnalysis(self, builder): </span>
<span class="lineNum">  313</span><span class="lineNoCov">      0  /   1:         global enable_value_analysis </span>
<span class="lineNum">  314</span><span class="lineCov">      1  /   1:         if not enable_value_analysis: </span>
<span class="lineNum">  315</span><span class="lineCov">      1  /   1:             mnuValueAnalysis = builder.get_object(&#039;mnuValueAnalysis&#039;) </span>
<span class="lineNum">  316</span><span class="lineCov">      1  /   1:             mnuValueAnalysis.set_sensitive(False) </span>
<span class="lineNum">  317</span>              :  </span>
<span class="lineNum">  318</span><span class="lineCov">      1  /   1:     def on_mnuValueAnalysis_activate(self, widget): </span>
<span class="lineNum">  319</span><span class="lineNoCov">      0  /   1:         print &#039;Doing value analysis&#039; </span>
<span class="lineNum">  320</span><span class="lineNoCov">      0  /   1:         self.valueAnalysisInfoProvider.analyse() </span>
<span class="lineNum">  321</span><span class="lineNoCov">      0  /   1:         print &#039;Done&#039; </span>
<span class="lineNum">  322</span>              :  </span>
<span class="lineNum">  323</span><span class="lineCov">      1  /   1:     def patternMatchBinCallback(self, entry, comboBox): </span>
<span class="lineNum">  324</span><span class="lineNoCov">      0  /   1:         markPattern = entry.get_text() </span>
<span class="lineNum">  325</span><span class="lineNoCov">      0  /   1:         self.searchwordHighlighter.setSearchPattern(markPattern) </span>
<span class="lineNum">  326</span><span class="lineNoCov">      0  /   1:         self.redisplayFunction() </span>
<span class="lineNum">  327</span><span class="lineNoCov">      0  /   1:         self.instructionView.grab_focus() </span>
<span class="lineNum">  328</span>              :  </span>
<span class="lineNum">  329</span><span class="lineCov">      1  /   1:     def lookupFunction(self, val): </span>
<span class="lineNum">  330</span><span class="lineNoCov">      0  /   1:         function = self.fileContainer.lookup(val) </span>
<span class="lineNum">  331</span><span class="lineNoCov">      0  /   1:         history.disable() </span>
<span class="lineNum">  332</span>              :  </span>
<span class="lineNum">  333</span><span class="lineNoCov">      0  /   1:         if function != None: </span>
<span class="lineNum">  334</span><span class="lineNoCov">      0  /   1:             model = self.functionView.get_model() </span>
<span class="lineNum">  335</span><span class="lineNoCov">      0  /   1:             self.functionView.set_cursor_on_cell(model.get_path(function.iter)) </span>
<span class="lineNum">  336</span><span class="lineNoCov">      0  /   1:             self.functionView.row_activated(model.get_path(function.iter), self.functionController.viewColumns[0]) </span>
<span class="lineNum">  337</span>              :  </span>
<span class="lineNum">  338</span>              :             # Return if this was just a label lookup </span>
<span class="lineNum">  339</span><span class="lineNoCov">      0  /   1:             if isinstance(val, str): </span>
<span class="lineNum">  340</span><span class="lineNoCov">      0  /   1:                 history.enable() </span>
<span class="lineNum">  341</span><span class="lineNoCov">      0  /   1:                 return True </span>
<span class="lineNum">  342</span><span class="lineNoCov">      0  /   1:             insn = function.lookup(val) </span>
<span class="lineNum">  343</span>              :  </span>
<span class="lineNum">  344</span><span class="lineNoCov">      0  /   1:             if insn != None: </span>
<span class="lineNum">  345</span><span class="lineNoCov">      0  /   1:                 model = self.instructionView.get_model() </span>
<span class="lineNum">  346</span><span class="lineNoCov">      0  /   1:                 self.instructionView.set_cursor_on_cell(model.get_path(insn.iter)) </span>
<span class="lineNum">  347</span><span class="lineNoCov">      0  /   1:             history.enable() </span>
<span class="lineNum">  348</span><span class="lineNoCov">      0  /   1:             return True </span>
<span class="lineNum">  349</span>              :  </span>
<span class="lineNum">  350</span><span class="lineNoCov">      0  /   1:         history.enable() </span>
<span class="lineNum">  351</span><span class="lineNoCov">      0  /   1:         return False </span>
<span class="lineNum">  352</span>              :  </span>
<span class="lineNum">  353</span><span class="lineCov">      1  /   1:     def addPasteBinEntry(self, comboBox, txt): </span>
<span class="lineNum">  354</span>              :         &quot;&quot;&quot;Add an entry to the pasteBin ComboBox. If the same entry is already </span>
<span class="lineNum">  355</span>              : there, promote it to the top of the list&quot;&quot;&quot; </span>
<span class="lineNum">  356</span><span class="lineNoCov">      0  /   1:         count = 0 </span>
<span class="lineNum">  357</span><span class="lineNoCov">      0  /   1:         found = -1 </span>
<span class="lineNum">  358</span><span class="lineNoCov">      0  /   1:         for item in iter(comboBox.get_model()): </span>
<span class="lineNum">  359</span><span class="lineNoCov">      0  /   1:             if item[0] == txt: </span>
<span class="lineNum">  360</span><span class="lineNoCov">      0  /   1:                 found = count </span>
<span class="lineNum">  361</span><span class="lineNoCov">      0  /   1:             count = count + 1 </span>
<span class="lineNum">  362</span>              :  </span>
<span class="lineNum">  363</span>              :         # If it&#039;s found, remove it from the list </span>
<span class="lineNum">  364</span><span class="lineNoCov">      0  /   1:         if found != -1: </span>
<span class="lineNum">  365</span><span class="lineNoCov">      0  /   1:             comboBox.remove_text(found) </span>
<span class="lineNum">  366</span>              :  </span>
<span class="lineNum">  367</span>              :         # ... and add it again </span>
<span class="lineNum">  368</span><span class="lineNoCov">      0  /   1:         comboBox.prepend_text(txt) </span>
<span class="lineNum">  369</span>              :  </span>
<span class="lineNum">  370</span><span class="lineCov">      1  /   1:     def lookupWord(self, word): </span>
<span class="lineNum">  371</span>              :         &quot;&quot;&quot;Lookup a word &#047;address&quot;&quot;&quot; </span>
<span class="lineNum">  372</span>              :         # Special-case Linux crashes </span>
<span class="lineNum">  373</span><span class="lineNoCov">      0  /   1:         r = linuxKernelCrashRegexp.match(word) </span>
<span class="lineNum">  374</span><span class="lineNoCov">      0  /   1:         if r != None: </span>
<span class="lineNum">  375</span><span class="lineNoCov">      0  /   1:             fn_name = r.group(1) </span>
<span class="lineNum">  376</span><span class="lineNoCov">      0  /   1:             fn_addend = r.group(2) </span>
<span class="lineNum">  377</span><span class="lineNoCov">      0  /   1:             function = self.fileContainer.lookup(fn_name) </span>
<span class="lineNum">  378</span>              :  </span>
<span class="lineNum">  379</span><span class="lineNoCov">      0  /   1:             if function != None: </span>
<span class="lineNum">  380</span><span class="lineNoCov">      0  /   1:                 val=function.address + long(fn_addend, 16) </span>
<span class="lineNum">  381</span><span class="lineNoCov">      0  /   1:                 if self.lookupFunction( val ): </span>
<span class="lineNum">  382</span><span class="lineNoCov">      0  /   1:                     history.add(val) </span>
<span class="lineNum">  383</span><span class="lineNoCov">      0  /   1:             return </span>
<span class="lineNum">  384</span>              :  </span>
<span class="lineNum">  385</span><span class="lineNoCov">      0  /   1:         try: </span>
<span class="lineNum">  386</span>              :             # Try to convert to a number (handle some common cases) </span>
<span class="lineNum">  387</span><span class="lineNoCov">      0  /   1:             word = word.strip(&quot;[]+():-&#047;|&gt;&lt;&quot;) </span>
<span class="lineNum">  388</span><span class="lineNoCov">      0  /   1:             val = long(word, 16) </span>
<span class="lineNum">  389</span><span class="lineNoCov">      0  /   1:         except: </span>
<span class="lineNum">  390</span><span class="lineNoCov">      0  /   1:             val = word </span>
<span class="lineNum">  391</span><span class="lineNoCov">      0  /   1:         if self.lookupFunction(val): </span>
<span class="lineNum">  392</span><span class="lineNoCov">      0  /   1:             history.add(val) </span>
<span class="lineNum">  393</span>              :  </span>
<span class="lineNum">  394</span><span class="lineCov">      1  /   1:     def pasteBinEntryActivated(self, entry, comboBox): </span>
<span class="lineNum">  395</span>              :         &quot;&quot;&quot; </span>
<span class="lineNum">  396</span>              :         Called to lookup a symbol &#047; address. Looks up a label or an </span>
<span class="lineNum">  397</span>              :         address. </span>
<span class="lineNum">  398</span>              :         &quot;&quot;&quot; </span>
<span class="lineNum">  399</span><span class="lineNoCov">      0  /   1:         txt = entry.get_text() </span>
<span class="lineNum">  400</span>              :  </span>
<span class="lineNum">  401</span><span class="lineNoCov">      0  /   1:         self.addPasteBinEntry(comboBox, txt) </span>
<span class="lineNum">  402</span>              :  </span>
<span class="lineNum">  403</span>              :         # Split the input in words and navigate to them </span>
<span class="lineNum">  404</span><span class="lineNoCov">      0  /   1:         for word in txt.split(): </span>
<span class="lineNum">  405</span><span class="lineNoCov">      0  /   1:             self.lookupWord(word) </span>
<span class="lineNum">  406</span>              :  </span>
<span class="lineNum">  407</span><span class="lineCov">      1  /   1:     def pasteBinChanged(self, comboBox, usr): </span>
<span class="lineNum">  408</span>              :         &quot;&quot;&quot; </span>
<span class="lineNum">  409</span>              :         Called when an entry in the paste bin list is selected </span>
<span class="lineNum">  410</span>              :         &quot;&quot;&quot; </span>
<span class="lineNum">  411</span><span class="lineNoCov">      0  /   1:         which = comboBox.get_active() </span>
<span class="lineNum">  412</span><span class="lineNoCov">      0  /   1:         if which != -1: </span>
<span class="lineNum">  413</span><span class="lineNoCov">      0  /   1:             txt = comboBox.get_model()[which][0] </span>
<span class="lineNum">  414</span><span class="lineNoCov">      0  /   1:             self.addPasteBinEntry(comboBox, txt) </span>
<span class="lineNum">  415</span><span class="lineNoCov">      0  /   1:             for word in txt.split(): </span>
<span class="lineNum">  416</span><span class="lineNoCov">      0  /   1:                 self.lookupWord(word) </span>
<span class="lineNum">  417</span>              :  </span>
<span class="lineNum">  418</span><span class="lineCov">      1  /   1:     def clearInstructionInfo(self): </span>
<span class="lineNum">  419</span><span class="lineCov">      1  /   1:         self.infoBox.set_markup(&#039;&lt;b&gt;Not available&lt;&#047;b&gt;&#039;) </span>
<span class="lineNum">  420</span>              :  </span>
<span class="lineNum">  421</span><span class="lineCov">      1  /   1:     def updateInstructionInfo(self, instruction): </span>
<span class="lineNum">  422</span>              :         # Check if this architecture supports instruction info </span>
<span class="lineNum">  423</span><span class="lineCov">      1  /   1:         if not hasattr(self.fileContainer.getArch(), &quot;getInstructionInfo&quot;): </span>
<span class="lineNum">  424</span><span class="lineCov">      1  /   1:             self.clearInstructionInfo() </span>
<span class="lineNum">  425</span><span class="lineCov">      1  /   1:             return </span>
<span class="lineNum">  426</span><span class="lineNoCov">      0  /   1:         instrInfo = self.fileContainer.getArch().getInstructionInfo(instruction) </span>
<span class="lineNum">  427</span>              :  </span>
<span class="lineNum">  428</span><span class="lineNoCov">      0  /   1:         valueAnalysisInfo = &quot;&quot; </span>
<span class="lineNum">  429</span><span class="lineNoCov">      0  /   1:         try: </span>
<span class="lineNum">  430</span><span class="lineNoCov">      0  /   1:             valueAnalysisInfo = self.valueAnalysisInfoProvider.getInstructionInfo(instruction) </span>
<span class="lineNum">  431</span><span class="lineNoCov">      0  /   1:         except AttributeError, e: </span>
<span class="lineNum">  432</span>              :             # Set above </span>
<span class="lineNum">  433</span><span class="lineNoCov">      0  /   1:             pass </span>
<span class="lineNum">  434</span>              :  </span>
<span class="lineNum">  435</span><span class="lineNoCov">      0  /   1:         self.infoBox.set_markup( </span>
<span class="lineNum">  436</span><span class="lineNoCov">      0  /   1:             &#039;&lt;b&gt;&#039; + instrInfo.get(&#039;shortinfo&#039;, &#039;&#039;) + &quot;&lt;&#047;b&gt;&lt;br &#047;&gt;&#092;n&#092;n&quot; + </span>
<span class="lineNum">  437</span><span class="lineNoCov">      0  /   1:             instrInfo.get(&#039;description&#039;, &#039;&#039;).replace(&#039;&#092;n&#039;, &#039;&lt;br &#047;&gt;&#092;n&#039;) + &quot;&#092;n&quot; + </span>
<span class="lineNum">  438</span><span class="lineNoCov">      0  /   1:             &#039;&lt;p&gt;&#039; + valueAnalysisInfo + &#039;&lt;&#047;p&gt;&#039; </span>
<span class="lineNum">  439</span><span class="lineNoCov">      0  /   1:             ) </span>
<span class="lineNum">  440</span>              :  </span>
<span class="lineNum">  441</span><span class="lineCov">      1  /   1:     def searchCommon(self, entity, key): </span>
<span class="lineNum">  442</span><span class="lineNoCov">      0  /   1:         key = key.lower() </span>
<span class="lineNum">  443</span><span class="lineNoCov">      0  /   1:         comp1 = (&quot;0x%08x&quot; % entity.address).lower() </span>
<span class="lineNum">  444</span><span class="lineNoCov">      0  /   1:         comp2 = entity.getLabel().lower() </span>
<span class="lineNum">  445</span><span class="lineNoCov">      0  /   1:         if isinstance(entity, Instruction): </span>
<span class="lineNum">  446</span><span class="lineNoCov">      0  /   1:             comp3 = entity.getOpcode() + entity.getArgs() </span>
<span class="lineNum">  447</span>              :         else: </span>
<span class="lineNum">  448</span><span class="lineNoCov">      0  /   1:             comp3 = &quot;&quot; </span>
<span class="lineNum">  449</span>              :  </span>
<span class="lineNum">  450</span>              :         # Lookup either the address or the label when doing an interactive </span>
<span class="lineNum">  451</span>              :         # search </span>
<span class="lineNum">  452</span><span class="lineNoCov">      0  /   1:         if comp1.find(key) != -1 or comp2.find(key) != -1 or comp3.find(key) != -1: </span>
<span class="lineNum">  453</span><span class="lineNoCov">      0  /   1:             return False </span>
<span class="lineNum">  454</span><span class="lineNoCov">      0  /   1:         return True </span>
<span class="lineNum">  455</span>              :  </span>
<span class="lineNum">  456</span><span class="lineCov">      1  /   1:     def run(self): </span>
<span class="lineNum">  457</span>              :         &quot;&quot;&quot; run is called to set off the GTK mainloop &quot;&quot;&quot; </span>
<span class="lineNum">  458</span><span class="lineCov">      1  /   1:         gtk.main() </span>
<span class="lineNum">  459</span><span class="lineCov">      1  /   1:         return </span>
<span class="lineNum">  460</span>              :  </span>
<span class="lineNum">  461</span><span class="lineCov">      1  /   1: class FunctionViewController: </span>
<span class="lineNum">  462</span>              :     &quot;&quot;&quot; Controls the Function TreeView &quot;&quot;&quot; </span>
<span class="lineNum">  463</span>              :  </span>
<span class="lineNum">  464</span><span class="lineCov">      1  /   1:     def __init__(self, controller, treeview, instructionController): </span>
<span class="lineNum">  465</span><span class="lineCov">      1  /   1:         self.controller = controller </span>
<span class="lineNum">  466</span><span class="lineCov">      1  /   1:         self.functionView = treeview </span>
<span class="lineNum">  467</span><span class="lineCov">      1  /   1:         self.instructionController = instructionController </span>
<span class="lineNum">  468</span>              :  </span>
<span class="lineNum">  469</span><span class="lineCov">      1  /   1:         self.setupFunctionView() </span>
<span class="lineNum">  470</span>              :  </span>
<span class="lineNum">  471</span><span class="lineCov">      1  /   1:     def setupFunctionView(self): </span>
<span class="lineNum">  472</span>              :         &quot;&quot;&quot; Sets up the columns to be displayed &quot;&quot;&quot; </span>
<span class="lineNum">  473</span>              :  </span>
<span class="lineNum">  474</span>              :         # setup the cell renderers </span>
<span class="lineNum">  475</span><span class="lineCov">      1  /   1:         self.functionRenderer = gtk.CellRendererText() </span>
<span class="lineNum">  476</span><span class="lineCov">      1  /   1:         self.functionRenderer.set_property(&quot;font&quot;, &quot;Monospace&quot;) </span>
<span class="lineNum">  477</span>              :  </span>
<span class="lineNum">  478</span><span class="lineCov">      1  /   1:         self.functionView.connect( &#039;row-activated&#039;, self.functionRowActivated) </span>
<span class="lineNum">  479</span><span class="lineCov">      1  /   1:         self.functionView.set_search_column(0) </span>
<span class="lineNum">  480</span><span class="lineCov">      1  /   1:         self.functionView.set_search_equal_func(self.functionSearchCallback) </span>
<span class="lineNum">  481</span>              :  </span>
<span class="lineNum">  482</span><span class="lineCov">      1  /   1:         self.viewColumns = {} </span>
<span class="lineNum">  483</span>              :         # Connect column0 of the display with column 0 in our list model </span>
<span class="lineNum">  484</span>              :         # The renderer will then display whatever is in column 0 of </span>
<span class="lineNum">  485</span>              :         # our model . </span>
<span class="lineNum">  486</span><span class="lineCov">      1  /   1:         self.viewColumns[0] = gtk.TreeViewColumn(&quot;Address&quot;, self.functionRenderer, markup=0) </span>
<span class="lineNum">  487</span><span class="lineCov">      1  /   1:         self.viewColumns[1] = gtk.TreeViewColumn(&quot;Size&quot;, self.functionRenderer, markup=1) </span>
<span class="lineNum">  488</span><span class="lineCov">      1  /   1:         self.viewColumns[2] = gtk.TreeViewColumn(&quot;Label&quot;, self.functionRenderer, markup=2) </span>
<span class="lineNum">  489</span>              :  </span>
<span class="lineNum">  490</span>              :         # The columns active state is attached to the second column </span>
<span class="lineNum">  491</span>              :         # in the model.  So when the model says True then the button </span>
<span class="lineNum">  492</span>              :         # will show as active e.g on. </span>
<span class="lineNum">  493</span><span class="lineCov">      1  /   1:         for col in self.viewColumns.values(): </span>
<span class="lineNum">  494</span><span class="lineCov">      1  /   1:             self.functionView.append_column( col ) </span>
<span class="lineNum">  495</span>              :  </span>
<span class="lineNum">  496</span><span class="lineCov">      1  /   1:     def functionSearchCallback(self, model, column, key, iter): </span>
<span class="lineNum">  497</span>              :         &quot;&quot;&quot; </span>
<span class="lineNum">  498</span>              :         Callback for interactive searches. </span>
<span class="lineNum">  499</span>              :         &quot;&quot;&quot; </span>
<span class="lineNum">  500</span><span class="lineNoCov">      0  /   1:         entity = model[iter][3] </span>
<span class="lineNum">  501</span><span class="lineNoCov">      0  /   1:         return self.controller.searchCommon(entity, key) </span>
<span class="lineNum">  502</span>              :  </span>
<span class="lineNum">  503</span><span class="lineCov">      1  /   1:     def functionRowActivated( self, view, iter, path): </span>
<span class="lineNum">  504</span>              :         &quot;&quot;&quot; </span>
<span class="lineNum">  505</span>              :         Run when one row is selected (double-click&#047;space) </span>
<span class="lineNum">  506</span>              :         &quot;&quot;&quot; </span>
<span class="lineNum">  507</span><span class="lineCov">      1  /   1:         model = self.functionView.get_model() </span>
<span class="lineNum">  508</span><span class="lineCov">      1  /   1:         entity = model[iter][3] </span>
<span class="lineNum">  509</span><span class="lineCov">      1  /   1:         entity.link() </span>
<span class="lineNum">  510</span><span class="lineCov">      1  /   1:         history.add(entity.address) </span>
<span class="lineNum">  511</span>              :  </span>
<span class="lineNum">  512</span><span class="lineCov">      1  /   1:         self.instructionController.setInstructionModel(entity) </span>
<span class="lineNum">  513</span>              :  </span>
<span class="lineNum">  514</span><span class="lineCov">      1  /   1: class InstructionViewController: </span>
<span class="lineNum">  515</span>              :     &quot;&quot;&quot; Controls the Instruction TreeView &quot;&quot;&quot; </span>
<span class="lineNum">  516</span>              :  </span>
<span class="lineNum">  517</span><span class="lineCov">      1  /   1:     def __init__(self, controller, treeview): </span>
<span class="lineNum">  518</span><span class="lineCov">      1  /   1:         self.controller = controller </span>
<span class="lineNum">  519</span><span class="lineCov">      1  /   1:         self.insnView = treeview </span>
<span class="lineNum">  520</span>              :  </span>
<span class="lineNum">  521</span><span class="lineCov">      1  /   1:         self.setupInstructionView() </span>
<span class="lineNum">  522</span>              :  </span>
<span class="lineNum">  523</span><span class="lineCov">      1  /   1:     def setupInstructionView(self): </span>
<span class="lineNum">  524</span>              :         # setup the cell renderers </span>
<span class="lineNum">  525</span><span class="lineCov">      1  /   1:         link_renderer = gtk.CellRendererPixbuf() </span>
<span class="lineNum">  526</span>              :  </span>
<span class="lineNum">  527</span><span class="lineCov">      1  /   1:         insnRenderer = gtk.CellRendererText() </span>
<span class="lineNum">  528</span><span class="lineCov">      1  /   1:         addressRenderer = gtk.CellRendererText() </span>
<span class="lineNum">  529</span><span class="lineCov">      1  /   1:         callDstRenderer = gtk.CellRendererText() </span>
<span class="lineNum">  530</span>              :  </span>
<span class="lineNum">  531</span><span class="lineCov">      1  /   1:         addressRenderer.set_property(&quot;font&quot;, &quot;Monospace&quot;) </span>
<span class="lineNum">  532</span><span class="lineCov">      1  /   1:         insnRenderer.set_property(&quot;font&quot;, &quot;Monospace&quot;) </span>
<span class="lineNum">  533</span><span class="lineCov">      1  /   1:         insnRenderer.set_property(&quot;width&quot;, 500) </span>
<span class="lineNum">  534</span><span class="lineCov">      1  /   1:         link_renderer.set_property(&quot;width&quot;, 22) </span>
<span class="lineNum">  535</span><span class="lineCov">      1  /   1:         link_renderer.set_property(&quot;height&quot;, 22) </span>
<span class="lineNum">  536</span><span class="lineCov">      1  /   1:         insnRenderer.set_property(&quot;height&quot;, 22) </span>
<span class="lineNum">  537</span><span class="lineCov">      1  /   1:         insnRenderer.set_property(&quot;editable&quot;, True) </span>
<span class="lineNum">  538</span><span class="lineCov">      1  /   1:         insnRenderer.connect(&quot;edited&quot;, self.insnCommentEdited, self.insnView) </span>
<span class="lineNum">  539</span><span class="lineCov">      1  /   1:         insnRenderer.connect(&quot;editing-started&quot;, self.insnCommentEditStart, self.insnView) </span>
<span class="lineNum">  540</span><span class="lineCov">      1  /   1:         callDstRenderer.set_property(&quot;font&quot;, &quot;Monospace&quot;) </span>
<span class="lineNum">  541</span>              :  </span>
<span class="lineNum">  542</span><span class="lineCov">      1  /   1:         self.insnView.connect( &#039;row-activated&#039;, self.insnRowActivated) </span>
<span class="lineNum">  543</span><span class="lineCov">      1  /   1:         self.insnView.connect_after( &#039;move-cursor&#039;, self.insnMoveCursor) </span>
<span class="lineNum">  544</span><span class="lineCov">      1  /   1:         self.insnView.connect( &#039;cursor-changed&#039;, self.insnCursorChanged ) </span>
<span class="lineNum">  545</span><span class="lineCov">      1  /   1:         self.insnView.connect( &#039;key-press-event&#039;, self.insnKeyPress ) </span>
<span class="lineNum">  546</span><span class="lineCov">      1  /   1:         self.insnView.set_search_column(0) </span>
<span class="lineNum">  547</span><span class="lineCov">      1  /   1:         self.insnView.set_search_equal_func(self.insnSearchCallback) </span>
<span class="lineNum">  548</span>              :  </span>
<span class="lineNum">  549</span><span class="lineCov">      1  /   1:         self.insnColumns = {} </span>
<span class="lineNum">  550</span>              :         # Connect column0 of the display with column 0 in our list model </span>
<span class="lineNum">  551</span>              :         # The renderer will then display whatever is in column 0 of </span>
<span class="lineNum">  552</span>              :         # our model . </span>
<span class="lineNum">  553</span><span class="lineCov">      1  /   1:         self.insnColumns[0] = gtk.TreeViewColumn(&quot;Address&quot;, addressRenderer, markup=0) </span>
<span class="lineNum">  554</span><span class="lineCov">      1  /   1:         self.insnColumns[1] = gtk.TreeViewColumn(&quot;b0&quot;, link_renderer, pixbuf=1) </span>
<span class="lineNum">  555</span><span class="lineCov">      1  /   1:         self.insnColumns[2] = gtk.TreeViewColumn(&quot;b1&quot;, link_renderer, pixbuf=2) </span>
<span class="lineNum">  556</span><span class="lineCov">      1  /   1:         self.insnColumns[3] = gtk.TreeViewColumn(&quot;b2&quot;, link_renderer, pixbuf=3) </span>
<span class="lineNum">  557</span><span class="lineCov">      1  /   1:         self.insnColumns[4] = gtk.TreeViewColumn(&quot;Instruction&quot;, insnRenderer, markup=4) </span>
<span class="lineNum">  558</span><span class="lineCov">      1  /   1:         self.insnColumns[4].set_resizable(True) </span>
<span class="lineNum">  559</span><span class="lineCov">      1  /   1:         self.insnColumns[5] = gtk.TreeViewColumn(&quot;f0&quot;, link_renderer, pixbuf=5) </span>
<span class="lineNum">  560</span><span class="lineCov">      1  /   1:         self.insnColumns[6] = gtk.TreeViewColumn(&quot;f1&quot;, link_renderer, pixbuf=6) </span>
<span class="lineNum">  561</span><span class="lineCov">      1  /   1:         self.insnColumns[7] = gtk.TreeViewColumn(&quot;f2&quot;, link_renderer, pixbuf=7) </span>
<span class="lineNum">  562</span><span class="lineCov">      1  /   1:         self.insnColumns[8] = gtk.TreeViewColumn(&quot;Target&quot;, callDstRenderer, markup=8) </span>
<span class="lineNum">  563</span>              :  </span>
<span class="lineNum">  564</span>              :         # The columns active state is attached to the second column </span>
<span class="lineNum">  565</span>              :         # in the model.  So when the model says True then the button </span>
<span class="lineNum">  566</span>              :         # will show as active e.g on. </span>
<span class="lineNum">  567</span><span class="lineCov">      1  /   1:         for col in self.insnColumns.values(): </span>
<span class="lineNum">  568</span><span class="lineCov">      1  /   1:             self.insnView.append_column( col ) </span>
<span class="lineNum">  569</span>              :  </span>
<span class="lineNum">  570</span><span class="lineCov">      1  /   1:     def setInstructionModel(self, functionEntity): </span>
<span class="lineNum">  571</span>              :         &quot;&quot;&quot; </span>
<span class="lineNum">  572</span>              :         Change the instruction model. </span>
<span class="lineNum">  573</span>              :         &quot;&quot;&quot; </span>
<span class="lineNum">  574</span><span class="lineCov">      1  /   1:         self.controller.instructionModel = InstructionModel.InfoModel(functionEntity, </span>
<span class="lineNum">  575</span><span class="lineCov">      1  /   1:             highlighters=self.controller.highlighters) </span>
<span class="lineNum">  576</span><span class="lineCov">      1  /   1:         model = self.controller.instructionModel.getModel() </span>
<span class="lineNum">  577</span><span class="lineCov">      1  /   1:         self.insnView.set_model( model ) </span>
<span class="lineNum">  578</span>              :  </span>
<span class="lineNum">  579</span><span class="lineCov">      1  /   1:         self.insnView.grab_focus() </span>
<span class="lineNum">  580</span><span class="lineCov">      1  /   1:         self.insnView.set_cursor(0) </span>
<span class="lineNum">  581</span>              :  </span>
<span class="lineNum">  582</span><span class="lineCov">      1  /   1:     def insnSearchCallback(self, model, column, key, iter): </span>
<span class="lineNum">  583</span>              :         &quot;&quot;&quot; </span>
<span class="lineNum">  584</span>              :         Callback for interactive searches. </span>
<span class="lineNum">  585</span>              :         &quot;&quot;&quot; </span>
<span class="lineNum">  586</span><span class="lineNoCov">      0  /   1:         entity = model[iter][self.controller.instructionModel.COLUMN_INSTRUCTION] </span>
<span class="lineNum">  587</span><span class="lineNoCov">      0  /   1:         if isinstance(entity, StrEntity): </span>
<span class="lineNum">  588</span><span class="lineNoCov">      0  /   1:             return True </span>
<span class="lineNum">  589</span><span class="lineNoCov">      0  /   1:         return self.controller.searchCommon(entity, key) </span>
<span class="lineNum">  590</span>              :  </span>
<span class="lineNum">  591</span><span class="lineCov">      1  /   1:     def insnKeyPress(self, view, event): </span>
<span class="lineNum">  592</span><span class="lineNoCov">      0  /   1:         if event.string == &#039;;&#039;: </span>
<span class="lineNum">  593</span><span class="lineNoCov">      0  /   1:             view.set_cursor(view.get_cursor()[0], focus_column=self.insnColumns[4], start_editing=True) </span>
<span class="lineNum">  594</span><span class="lineNoCov">      0  /   1:             return True </span>
<span class="lineNum">  595</span>              :  </span>
<span class="lineNum">  596</span><span class="lineCov">      1  /   1:     def insnCommentEditStart(self, insnRenderer, editable, path, insnView): </span>
<span class="lineNum">  597</span><span class="lineNoCov">      0  /   1:         model = insnView.get_model() </span>
<span class="lineNum">  598</span><span class="lineNoCov">      0  /   1:         iter = model.get_iter_from_string(path) </span>
<span class="lineNum">  599</span><span class="lineNoCov">      0  /   1:         insn = model[iter][self.controller.instructionModel.COLUMN_INSTRUCTION] </span>
<span class="lineNum">  600</span><span class="lineNoCov">      0  /   1:         editable.set_text(insn.comment) </span>
<span class="lineNum">  601</span>              :  </span>
<span class="lineNum">  602</span><span class="lineCov">      1  /   1:     def insnCommentEdited(self, insnRenderer, path, new_text, view): </span>
<span class="lineNum">  603</span><span class="lineNoCov">      0  /   1:         model = view.get_model() </span>
<span class="lineNum">  604</span><span class="lineNoCov">      0  /   1:         iter = model.get_iter_from_string(path) </span>
<span class="lineNum">  605</span><span class="lineNoCov">      0  /   1:         insn = model[iter][self.controller.instructionModel.COLUMN_INSTRUCTION] </span>
<span class="lineNum">  606</span><span class="lineNoCov">      0  /   1:         insn.comment = new_text </span>
<span class="lineNum">  607</span><span class="lineNoCov">      0  /   1:         view.set_cursor(view.get_cursor()[0], focus_column=self.insnColumns[0], start_editing=False) </span>
<span class="lineNum">  608</span>              :  </span>
<span class="lineNum">  609</span><span class="lineCov">      1  /   1:     def insnCursorChanged(self, view): </span>
<span class="lineNum">  610</span><span class="lineCov">      1  /   1:         model = view.get_model() </span>
<span class="lineNum">  611</span><span class="lineCov">      1  /   1:         cur = model[view.get_cursor()[0]][self.controller.instructionModel.COLUMN_INSTRUCTION] </span>
<span class="lineNum">  612</span><span class="lineCov">      1  /   1:         if isinstance(cur, Instruction): </span>
<span class="lineNum">  613</span><span class="lineCov">      1  /   1:             self.controller.updateInstructionInfo(cur) </span>
<span class="lineNum">  614</span><span class="lineCov">      1  /   1:             self.controller.instructionModel.setCurInstruction(cur) </span>
<span class="lineNum">  615</span><span class="lineCov">      1  /   1:             self.controller.instructionModel.refreshModel() </span>
<span class="lineNum">  616</span>              :         else: </span>
<span class="lineNum">  617</span><span class="lineNoCov">      0  /   1:             self.controller.clearInstructionInfo() </span>
<span class="lineNum">  618</span>              :  </span>
<span class="lineNum">  619</span><span class="lineCov">      1  /   1:     def insnMoveCursor(self, view, step, count): </span>
<span class="lineNum">  620</span><span class="lineNoCov">      0  /   1:         model = view.get_model() </span>
<span class="lineNum">  621</span><span class="lineNoCov">      0  /   1:         if not model: </span>
<span class="lineNum">  622</span><span class="lineNoCov">      0  /   1:             return True </span>
<span class="lineNum">  623</span><span class="lineNoCov">      0  /   1:         curpath = view.get_cursor()[0][0] </span>
<span class="lineNum">  624</span><span class="lineNoCov">      0  /   1:         origpath = view.get_cursor()[0][0] </span>
<span class="lineNum">  625</span>              :  </span>
<span class="lineNum">  626</span><span class="lineNoCov">      0  /   1:         if step == gtk.MOVEMENT_DISPLAY_LINES: </span>
<span class="lineNum">  627</span>              :             #Find next Instruction </span>
<span class="lineNum">  628</span><span class="lineNoCov">      0  /   1:             try: </span>
<span class="lineNum">  629</span><span class="lineNoCov">      0  /   1:                 while not isinstance(model[curpath][self.controller.instructionModel.COLUMN_INSTRUCTION], </span>
<span class="lineNum">  630</span><span class="lineNoCov">      0  /   1:                     Instruction): </span>
<span class="lineNum">  631</span><span class="lineNoCov">      0  /   1:                     curpath = curpath + count </span>
<span class="lineNum">  632</span><span class="lineNoCov">      0  /   1:             except IndexError: </span>
<span class="lineNum">  633</span>              :                 #Reverse move </span>
<span class="lineNum">  634</span><span class="lineNoCov">      0  /   1:                 curpath = origpath - count </span>
<span class="lineNum">  635</span><span class="lineNoCov">      0  /   1:             if curpath &lt; 0: </span>
<span class="lineNum">  636</span>              :                 #Reverse move </span>
<span class="lineNum">  637</span><span class="lineNoCov">      0  /   1:                 curpath = origpath - count </span>
<span class="lineNum">  638</span><span class="lineNoCov">      0  /   1:             view.set_cursor(curpath) </span>
<span class="lineNum">  639</span><span class="lineNoCov">      0  /   1:         return True </span>
<span class="lineNum">  640</span>              :  </span>
<span class="lineNum">  641</span><span class="lineCov">      1  /   1:     def insnRowActivated( self, view, iter, path): </span>
<span class="lineNum">  642</span>              :         &quot;&quot;&quot; </span>
<span class="lineNum">  643</span>              :         Run when one row is selected (double-click&#047;space) </span>
<span class="lineNum">  644</span>              :         &quot;&quot;&quot; </span>
<span class="lineNum">  645</span><span class="lineNoCov">      0  /   1:         model = view.get_model() </span>
<span class="lineNum">  646</span><span class="lineNoCov">      0  /   1:         functionModel = self.controller.functionView.get_model() </span>
<span class="lineNum">  647</span><span class="lineNoCov">      0  /   1:         try: </span>
<span class="lineNum">  648</span><span class="lineNoCov">      0  /   1:             entity = model[iter][self.controller.instructionModel.COLUMN_INSTRUCTION] </span>
<span class="lineNum">  649</span><span class="lineNoCov">      0  /   1:         except IndexError: </span>
<span class="lineNum">  650</span>              :             # If the index is outside of the model </span>
<span class="lineNum">  651</span><span class="lineNoCov">      0  /   1:             return </span>
<span class="lineNum">  652</span><span class="lineNoCov">      0  /   1:         if isinstance(entity, Instruction) and entity.hasLink(): </span>
<span class="lineNum">  653</span><span class="lineNoCov">      0  /   1:             link = entity.getOutLink() </span>
<span class="lineNum">  654</span><span class="lineNoCov">      0  /   1:             history.add(entity.address) </span>
<span class="lineNum">  655</span><span class="lineNoCov">      0  /   1:             if isinstance(link, Function): </span>
<span class="lineNum">  656</span><span class="lineNoCov">      0  /   1:                 history.add(link.address) </span>
<span class="lineNum">  657</span><span class="lineNoCov">      0  /   1:                 dst = link </span>
<span class="lineNum">  658</span><span class="lineNoCov">      0  /   1:                 self.controller.functionView.set_cursor_on_cell(functionModel.get_path(dst.iter)) </span>
<span class="lineNum">  659</span><span class="lineNoCov">      0  /   1:                 self.controller.functionView.row_activated(functionModel.get_path(dst.iter), self.controller.functionController.viewColumns[0]) </span>
<span class="lineNum">  660</span><span class="lineNoCov">      0  /   1:                 view.set_cursor_on_cell(0) </span>
<span class="lineNum">  661</span>              :             else: </span>
<span class="lineNum">  662</span><span class="lineNoCov">      0  /   1:                 func = entity.getFunction() </span>
<span class="lineNum">  663</span><span class="lineNoCov">      0  /   1:                 dst = func.lookup(link.address) </span>
<span class="lineNum">  664</span><span class="lineNoCov">      0  /   1:                 if dst != None: </span>
<span class="lineNum">  665</span><span class="lineNoCov">      0  /   1:                     history.add(dst.address) </span>
<span class="lineNum">  666</span><span class="lineNoCov">      0  /   1:                     view.set_cursor(model.get_path(dst.iter)) </span>
<span class="lineNum">  667</span>              :  </span>
<span class="lineNum">  668</span><span class="lineCov">      1  /   1: def usage(): </span>
<span class="lineNum">  669</span><span class="lineNoCov">      0  /   1:     print &quot;Usage: %s -h [FILE]&quot; % (PROGRAM_NAME.lower()) </span>
<span class="lineNum">  670</span><span class="lineNoCov">      0  /   1:     print &quot;Disassemble FILE and open in a graphical window.&#092;n&quot; </span>
<span class="lineNum">  671</span><span class="lineNoCov">      0  /   1:     print &quot;  -t BASE_ADDRESS       Set the start address for the disassembled file (.text segment)&quot; </span>
<span class="lineNum">  672</span><span class="lineNoCov">      0  /   1:     print &quot;  -h                    Display this help and exit&quot; </span>
<span class="lineNum">  673</span><span class="lineNoCov">      0  /   1:     sys.exit(1) </span>
<span class="lineNum">  674</span>              :  </span>
<span class="lineNum">  675</span><span class="lineCov">      1  /   1: baseAddress = 0 </span>
<span class="lineNum">  676</span><span class="lineCov">      1  /   1: if __name__ == &quot;__main__&quot;: </span>
<span class="lineNum">  677</span><span class="lineCov">      1  /   1:     optlist, args = getopt.gnu_getopt(sys.argv[1:], &quot;ht:&quot;) </span>
<span class="lineNum">  678</span>              :  </span>
<span class="lineNum">  679</span><span class="lineCov">      1  /   1:     for opt, arg in optlist: </span>
<span class="lineNum">  680</span><span class="lineNoCov">      0  /   1:         if opt == &quot;-h&quot;: </span>
<span class="lineNum">  681</span><span class="lineNoCov">      0  /   1:             usage() </span>
<span class="lineNum">  682</span><span class="lineNoCov">      0  /   1:         if opt == &quot;-t&quot;: </span>
<span class="lineNum">  683</span><span class="lineNoCov">      0  /   1:             try: </span>
<span class="lineNum">  684</span><span class="lineNoCov">      0  /   1:                 baseAddress = long(arg) </span>
<span class="lineNum">  685</span><span class="lineNoCov">      0  /   1:             except: </span>
<span class="lineNum">  686</span><span class="lineNoCov">      0  /   1:                 try: </span>
<span class="lineNum">  687</span><span class="lineNoCov">      0  /   1:                     baseAddress = long(arg, 16) </span>
<span class="lineNum">  688</span><span class="lineNoCov">      0  /   1:                 except: </span>
<span class="lineNum">  689</span><span class="lineNoCov">      0  /   1:                     raise </span>
<span class="lineNum">  690</span><span class="lineCov">      1  /   1:     if len(args) == 0: </span>
<span class="lineNum">  691</span><span class="lineNoCov">      0  /   1:         filename = None </span>
<span class="lineNum">  692</span>              :     else: </span>
<span class="lineNum">  693</span><span class="lineCov">      1  /   1:         filename = args[0] </span>
<span class="lineNum">  694</span>              :  </span>
<span class="lineNum">  695</span><span class="lineCov">      1  /   1:     myGUI = GUI_Controller(filename) </span>
<span class="lineNum">  696</span><span class="lineCov">      1  /   1:     myGUI.run() </span>
</pre>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
  <tr><td class="ruler"><img src="glass.png" width="3" height="3" alt=""/></td></tr>
  <tr><td class="versionInfo">Generated by: <a href="http://simonkagstrom.github.com/kcov/index.html">Kcov</a></td></tr>
</table>
<br/>
</body>
</html>
